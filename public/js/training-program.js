const curriculum = {
    8: {
        'Информационни технологии ': {
            description: '',
            category: 'advanced-professional'
        },
        'Предприемачество': {
            description: '',
            category: 'general-professional'
        },
        'Български език и литература': {
            description: '',
            category: 'general'
        },
        'Английски език': {
            description: '',
            category: 'general'
        },
        'Математика': {
            description: '',
            category: 'general'
        },
        'Информационни технологии': {
            description: '',
            category: 'general'
        },
        'История и цивилизации': {
            description: '',
            category: 'general'
        },
        'География и икономика': {
            description: '',
            category: 'general'
        },
        'Философия': {
            description: '',
            category: 'general'
        },
        'Биология и здравно образование': {
            description: '',
            category: 'general'
        },
        'Физика и астрономия': {
            description: '',
            category: 'general'
        },
        'Химия и опазване на околната среда': {
            description: '',
            category: 'general'
        },
        'Музика': {
            description: '',
            category: 'general'
        },
        'Изобразително изкуство': {
            description: '',
            category: 'general'
        },
        'Физическо възпитание и спорт': {
            description: '',
            category: 'general'
        }
    },
    9: {
        'Увод в програмирането': {
            description: '',
            category: 'professional'
        },
        'Програмиране': {
            description: '',
            category: 'professional'
        },
        'Увод в обектно-ориентираното програмиране': {
            description: '',
            category: 'professional'
        },
        'Здравословни и безопасни условия на труд': {
            description: '',
            category: 'general-professional'
        },
        'Български език и литература': {
            description: '',
            category: 'general'
        },
        'Английски език': {
            description: '',
            category: 'general'
        },
        'Немски език': {
            description: '',
            category: 'general'
        },
        'Математика': {
            description: '',
            category: 'general'
        },        
        'Информационни технологии': {
            description: '',
            category: 'general'
        },
        'История и цивилизации': {
            description: '',
            category: 'general'
        },
        'География и икономика': {
            description: '',
            category: 'general'
        },
        'Философия': {
            description: '',
            category: 'general'
        },
        'Биология и здравно образование': {
            description: '',
            category: 'general'
        },
        'Физика и астрономия': {
            description: '',
            category: 'general'
        },
        'Химия и опазване на околната среда': {
            description: '',
            category: 'general'
        },
        'Изобразително изкуство': {
            description: '',
            category: 'general'
        },
        'Физическо възпитание и спорт': {
            description: '',
            category: 'general'
        }
    },
    10: {
        'Увод в алгоритмите и структурите от данни': {
            description: '',
            category: 'professional'
        },
        'Програмиране на микроконтролери': {
            description: '',
            category: 'advanced-professional'
        },
        'Визуално програмиране': {
            description: '',
            category: 'advanced-professional'
        },
        'Икономика': {
            description: '',
            category: 'general-professional'
        },
        'Производствена практика': {
            description: '',
            category: 'practice'
        },
        'Български език и литература': {
            description: '',
            category: 'general'
        },
        'Английски език': {
            description: '',
            category: 'general'
        },
        'Немски език': {
            description: '',
            category: 'general'
        },
        'Математика': {
            description: '',
            category: 'general'
        },
        'Информационни технологии': {
            description: '',
            category: 'general'
        },
        'История и цивилизации': {
            description: '',
            category: 'general'
        },
        'География и икономика': {
            description: '',
            category: 'general'
        },
        'Философия': {
            description: '',
            category: 'general'
        },
        'Биология и здравно образование': {
            description: '',
            category: 'general'
        },
        'Физика и астрономия': {
            description: '',
            category: 'general'
        },
        'Химия и опазване на околната среда': {
            description: '',
            category: 'general'
        },
        'Физическо възпитание и спорт': {
            description: '',
            category: 'general'
        }
    },
    11: {
        'Обектно-ориентирано програмиране': {
            description: '',
            category: 'professional'
        },

        'Бази данни': {
            description: '',
            category: 'professional'
        },
        'Разработка на софтуер': {
            description: '',
            category: 'professional'
        },
        'Програмиране за вградени системи': {
            description: '',
            category: 'specific-professional'
        },
        'Математически основи на програмирането': {
            description: '',
            category: 'specific-professional'
        },
        'Операционни системи': {
            description: '',
            category: 'specific-professional'
        },
        'Конкурентно програмиране': {
            description: '',
            category: 'specific-professional'
        },
        'Чужд език по професията': {
            description: '',
            category: 'general-professional'
        },
        'Производствена практика': {
            description: '',
            category: 'practice'
        },
        'Български език и литература': {
            description: '',
            category: 'general'
        },
        'Немски език': {
            description: '',
            category: 'general'
        },
        'Математика': {
            description: '',
            category: 'general'
        },
        'Гражданско образование': {
            description: '',
            category: 'general'
        },
        'Физическо възпитание и спорт': {
            description: '',
            category: 'general'
        }
    },
    12: {
        'Алгоритми и структури от данни': {
            description: '',
            category: 'specific-professional'
        },
        'Функционално програмиране': {
            description: '',
            category: 'specific-professional'
        },
        'Интернет програмиране': {
            description: '',
            category: 'specific-professional'
        },
        'Софтуерно инженерство': {
            description: '',
            category: 'specific-professional'
        },
        'Чужд език по професията': {
            description: '',
            category: 'general-professional'
        },
        'Производствена практика': {
            description: '',
            category: 'practice'
        },
        'Български език и литература': {
            description: '',
            category: 'general'
        },
        'Немски език': {
            description: '',
            category: 'general'
        },
        'Математика': {
            description: '',
            category: 'general'
        },
        'Гражданско образование': {
            description: '',
            category: 'general'
        },
        'Физическо възпитание и спорт': {
            description: '',
            category: 'general'
        }
    }
};

// Онлайн икони за различните предмети
const subjectIcons = {
    'Софтуерно инженерство': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/code-slash.svg',
    'Увод в алгоритмите и структурите от данни': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/diagram-3.svg',
    'Програмиране': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/braces.svg',
    'Обектно-ориентирано програмиране': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/boxes.svg',
    'Увод в обектно-ориентираното програмиране': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/box.svg',
    'Бази данни': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/database.svg',
    'Разработка на софтуер': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/code-square.svg',
    'Операционни системи': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/cpu.svg',
    'Конкурентно програмиране': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/code-slash.svg',
    'Функционално програмиране': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/braces-asterisk.svg',
    'Интернет програмиране': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/globe.svg',
    'Програмиране за вградени системи': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/cpu-fill.svg',
    'Програмиране на микроконтролери': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/motherboard.svg',
    'Български език и литература': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/book.svg',
    'Математика': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/calculator.svg',
    'Английски език': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/translate.svg',
    'Немски език': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/translate.svg',
    'Физика и астрономия': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/stars.svg',
    'Увод в програмирането': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/code.svg',
    'Математически основи на програмирането': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/infinity.svg',
    'Алгоритми и структури от данни': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/diagram-2.svg',
    'Чужд език по професията': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/chat-square-text.svg',
    'География и икономика': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/globe-europe-africa.svg',
    'Биология и здравно образование': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/tree.svg',
    'Химия и опазване на околната среда': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/droplet.svg',
    'История и цивилизации': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/clock-history.svg',
    'Философия': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/lightbulb.svg',
    'Гражданско образование': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/people.svg',
    'Физическо възпитание и спорт': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/trophy.svg',
    'Предприемачество': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/briefcase.svg',
    'Здравословни и безопасни условия на труд': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/shield-check.svg',
    'Музика': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/music-note.svg',
    'Информационни технологии': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/pc-display.svg',
    'Изобразително изкуство': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/palette.svg',    
    'Информационни технологии': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/pc-display.svg',
    'Информационни технологии ': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/pc-display.svg',
    'Производствена практика': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/briefcase.svg',
    'Икономика': 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/bar-chart.svg'
};

let currentGrade = null;
let activeTimeouts = [];

// Функция за чистене на стари таймаути
function clearAllTimeouts() {
  activeTimeouts.forEach(id => clearTimeout(id));
  activeTimeouts = [];
}

function showGrade(grade) {
  // Ако е същия клас – нищо не правим
  if (currentGrade === grade) return;

  // Спираме всички текущи анимации
  clearAllTimeouts();

  const gradeTitle = document.getElementById('grade-title');
  const subjectsDiv = document.getElementById('subjects');

  // Анимация за изчезване (много кратко, само за плавен преход)
  subjectsDiv.style.opacity = '0';
  subjectsDiv.style.transform = 'translateY(-20px)';
  gradeTitle.classList.remove('animate');
  void gradeTitle.offsetWidth;
  gradeTitle.classList.add('animate');

  // След 300ms обновяваме съдържанието
  activeTimeouts.push(setTimeout(() => {
    gradeTitle.textContent = `${grade} клас`;
    subjectsDiv.innerHTML = '';

    const subjects = curriculum[grade];
    if (!subjects || Object.keys(subjects).length === 0) {
      const emptyMessage = document.createElement('div');
      emptyMessage.className = 'empty-message';
      emptyMessage.textContent = 'Информацията за този клас скоро ще бъде добавена.';
      subjectsDiv.appendChild(emptyMessage);
      subjectsDiv.style.opacity = '1';
      subjectsDiv.style.transform = 'translateY(0)';
      currentGrade = grade;
      return;
    }

    // Легенда
    const legend = document.createElement('div');
    legend.className = 'legend';
    legend.innerHTML = `
      <div class="legend-item"><div class="legend-color legend-professional"></div><span>Отраслова професионална подготовка</span></div>
      <div class="legend-item"><div class="legend-color legend-specific-professional"></div><span>Специфична професионална подготовка</span></div>
      <div class="legend-item"><div class="legend-color legend-advanced-professional"></div><span>Разширена професионална подготовка</span></div>
      <div class="legend-item"><div class="legend-color legend-general-professional"></div><span>Обща професионална подготовка</span></div>
      <div class="legend-item"><div class="legend-color legend-practise"></div><span>Производствена практика</span></div>
      <div class="legend-item"><div class="legend-color legend-general"></div><span>Общообразователна подготовка</span></div>
    `;
    subjectsDiv.appendChild(legend);

    // Grid контейнер
    const gridContainer = document.createElement('div');
    gridContainer.className = 'subjects-grid';
    subjectsDiv.appendChild(gridContainer);

    // Сортиране и анимация на предметите
    const sortedSubjects = Object.entries(subjects);
    let delay = 0;
    for (const [subject, data] of sortedSubjects) {
      const el = document.createElement('div');
      el.className = 'subject';
      el.style.opacity = '0';
      el.style.transform = 'translateY(20px)';
      el.style.transition = 'all 0.4s cubic-bezier(0.4, 0, 0.2, 1)';
      el.style.transitionDelay = `${delay}s`;
      el.innerHTML = `
        <span class="subject-category ${data.category}">${getCategoryName(data.category)}</span>
        <h3><span class="subject-icon"><img src="${subjectIcons[subject]||'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/icons/question-circle.svg'}" alt="${subject}" width="24" height="24"></span>${subject}</h3>
        <p>${data.description}</p>
      `;
      gridContainer.appendChild(el);
      void el.offsetHeight;
      activeTimeouts.push(setTimeout(() => {
        el.style.opacity = '1';
        el.style.transform = 'translateY(0)';
      }, delay * 1000 + 50));
      delay += 0.1;
    }

    // Показваме съдържанието
    activeTimeouts.push(setTimeout(() => {
      subjectsDiv.style.opacity = '1';
      subjectsDiv.style.transform = 'translateY(0)';
      currentGrade = grade;
    }, 50));
  }, 300));

  // Обновяваме активния бутон
  document.querySelectorAll('.buttons button').forEach(btn => {
    btn.classList.toggle('active', btn.textContent.includes(grade.toString()));
  });
}



// Функция, която превръща кода на категорията в текст за показване
function getCategoryName(category) {
    const categoryNames = {
        'professional': 'Отраслова професионална подготовка',
        'specific-professional': 'Специфична професионална подготовка',
        'advanced-professional': 'Разширена професионална подготовка',
        'general-professional': 'Обща професионална подготовка',
        'practice': 'Производствена практика',
        'general': 'Общообразователна подготовка'
    };
    
    return categoryNames[category] || category;
}

// Инициализация при зареждане
document.addEventListener('DOMContentLoaded', () => {
// Добавяме CSS за иконите
const iconStyles = document.createElement('style');
iconStyles.textContent = `
    .subject-icon {
        display: inline-flex;
        justify-content: center;
        align-items: center;
        vertical-align: middle;
    }
    
    .icon-img {
        width: 24px;
        height: 24px;
        vertical-align: middle;
        margin-right: 8px;
        object-fit: contain;
    }
`;
document.head.appendChild(iconStyles);
    
    // Добавяме линк към Bootstrap Icons
    const iconLink = document.createElement('link');
    iconLink.rel = 'stylesheet';
    iconLink.href = 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css';
    document.head.appendChild(iconLink);
    
    // Добавяме клас за активен бутон при клик
    document.querySelectorAll('.buttons button').forEach(button => {
        button.addEventListener('click', function() {
            if (!isAnimating) {
                const grade = parseInt(this.textContent);
                showGrade(grade);
            }
        });
    });

    // Задаваме начално състояние
    const gradeTitle = document.getElementById('grade-title');
    const subjectsDiv = document.getElementById('subjects');
    
    gradeTitle.textContent = 'Изберете клас';
    gradeTitle.classList.add('initial');
    subjectsDiv.innerHTML = '';
    
    // Добавяме съобщение за начален избор с Bootstrap икона
    const initialMessage = document.createElement('div');
    initialMessage.className = 'empty-message';
    initialMessage.innerHTML = `
        <i class="bi bi-hand-index-thumb" style="font-size: 2rem; margin-bottom: 15px; color: #1a73e8;"></i>
        <p>Моля, изберете клас от бутоните по-горе, за да видите учебната програма.</p>
    `;
    subjectsDiv.appendChild(initialMessage);
});